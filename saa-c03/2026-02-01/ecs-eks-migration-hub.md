# AWS SAA-C03 学習メモ（2026-02-01）

## Docker（コンテナ）と Kubernetes の違い

### コンテナ（Docker）
アプリケーションをパッケージ化する技術

- アプリ + 依存関係をまとめて「箱」に入れる
- どの環境でも同じように動く
- 1つのコンテナ = 1つのアプリケーション単位

```
┌─────────────────┐
│  アプリケーション  │
│  ライブラリ       │
│  設定ファイル     │
└─────────────────┘
   = コンテナ
```

### Kubernetes（K8s）
コンテナを管理・運用するためのツール（オーケストレーター）

- 複数のコンテナをまとめて管理
- 自動スケーリング、負荷分散、自己修復
- 「コンテナが落ちたら自動で再起動」などを実現

```
┌─────────────────────────────────┐
│  Kubernetes                     │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐      │
│  │ C │ │ C │ │ C │ │ C │ ←コンテナ │
│  └───┘ └───┘ └───┘ └───┘      │
│  監視・スケール・復旧を自動化    │
└─────────────────────────────────┘
```

### 関係性
```
┌────────────────────────────────┐
│  Kubernetes（管理層）           │
│                                │
│  ┌──────┐ ┌──────┐ ┌──────┐   │
│  │Docker│ │Docker│ │Docker│   │
│  │コンテナ│ │コンテナ│ │コンテナ│   │
│  └──────┘ └──────┘ └──────┘   │
│                                │
│  → これらを監視・管理・自動復旧  │
└────────────────────────────────┘
```

**まとめ：Docker = 箱、Kubernetes = 箱を管理する仕組み**

---

## ECS と EKS の違い

### 基本情報

| 項目 | ECS | EKS |
|------|-----|-----|
| 正式名称 | Elastic Container Service | Elastic Kubernetes Service |
| 何か | AWS独自のコンテナオーケストレーター | マネージドKubernetes |
| 学習コスト | 低い（AWS特化で簡単） | 高い（K8sの知識が必要） |
| 柔軟性 | AWS内で完結 | マルチクラウド移行が容易 |
| 料金 | コントロールプレーン無料 | コントロールプレーン有料（約$75/月） |

### ECS と EKS の関係
- **完全に別のサービス**（どちらかがどちらかを管理する関係ではない）
- 同じ目的（コンテナ管理）を達成するための「別の道具」

```
コンテナを管理したい！
        │
        ├─→ ECS を使う（AWS独自方式）
        │
        └─→ EKS を使う（Kubernetes方式）
```

### 運用方法の違い

#### ECS の場合
```bash
# AWS CLI で操作
$ aws ecs update-service --cluster my-cluster --desired-count 5
```
- タスク定義（JSON）を書いてデプロイ
- AWSの用語・概念で完結

#### EKS の場合
```bash
# kubectl コマンドで操作
$ kubectl apply -f deployment.yaml
$ kubectl scale deployment my-app --replicas=5
```
- YAMLマニフェストを書いてデプロイ
- Kubernetesの用語・概念を学ぶ必要あり

### 用語の対応

| やりたいこと | ECS | EKS (Kubernetes) |
|------------|-----|------------------|
| コンテナの定義 | タスク定義 | Pod |
| サービスの単位 | サービス | Deployment + Service |
| クラスタ | クラスター | クラスター |
| スケール設定 | Auto Scaling | HPA |

### 機能の違い

#### 両方でできること
- コンテナを動かす
- 台数を増減する
- 自動スケール
- 落ちたら自動復旧
- ローリングデプロイ
- ロードバランサー連携

#### EKS でしかできない（or やりやすい）こと
- マルチクラウド運用（同じYAMLでAWSでもGCPでも動く）
- 高度なデプロイ戦略（カナリアリリース等）
- Helmでパッケージ管理
- カスタムコントローラー
- サービスメッシュ（Istio等）

#### ECS の方が楽なこと
- AWS連携がシンプル（IAM, CloudWatch等）
- Fargateとの相性が良い
- 運用の手間が少ない（K8sのアップグレード不要）

### 選択基準

| 既存アプリの状態 | おすすめ | 理由 |
|----------------|---------|------|
| Kubernetesで運用中 | EKS | そのまま移行できる |
| Docker Composeで運用 | ECS | 構造が似てる、ツールあり |
| コンテナ化されてない | ECS | 学習コスト低い |
| マイクロサービス大量 | EKS | 管理ツールが豊富 |
| 将来GCP等も使うかも | EKS | 移植性が高い |

### まとめ
```
ECS = AWSが用意した「簡単リモコン」でコンテナ操作
EKS = 業界標準の「多機能リモコン」でコンテナ操作

初めてならECSから始めるのがおすすめ
```

---

## コントロールプレーンとデータプレーン

### 概念
```
┌─────────────────────────────────┐
│  コントロールプレーン（司令塔）    │  ← 頭脳
│  ・何台動かすか決める            │
│  ・どこに配置するか決める         │
│  ・落ちたコンテナを検知           │
└─────────────────────────────────┘
              │
              │ 指示
              ▼
┌─────────────────────────────────┐
│  データプレーン（実働部隊）        │  ← 手足
│  ┌───┐ ┌───┐ ┌───┐            │
│  │ C │ │ C │ │ C │  ← 実際のコンテナ │
│  └───┘ └───┘ └───┘            │
└─────────────────────────────────┘
```

### 役割
- **コントロールプレーン** = 監視者 + 運用者
  - 24時間見張って、問題あれば自動で対処
  - 人間の運用者がやってたことを代わりにやる
- **データプレーン** = 実際に動く側（手足）

### ECS と EKS での違い

| サービス | コントロールプレーン | データプレーン |
|---------|-------------------|---------------|
| ECS | AWSが完全管理（**無料**） | EC2 or Fargate（有料） |
| EKS | AWSが管理（**有料：約$75/月**） | EC2 or Fargate（有料） |

---

## AWS Migration Hub

### 役割
```
実際に移行する ✗
移行の進捗を管理する ⭕
```

**ダッシュボード（管理画面）という位置づけ**

### 構成図
```
┌─────────────────────────────────────┐
│  AWS Migration Hub（ダッシュボード） │
│                                     │
│  「移行の全体像を一箇所で見る」       │
└─────────────────────────────────────┘
        │
        │ 状況を集約
        │
┌───────┴───────┬──────────────┐
▼               ▼              ▼
サーバー移行    DB移行       アプリ移行
(AWS MGN)      (AWS DMS)    (App2Container)

※ 実際の移行は別ツールがやる
```

### 機能
- 移行対象のサーバー/DBを一覧管理
- 各移行ツールの進捗を一元表示
- 「どこまで終わった？」を可視化
- 移行漏れがないかチェック

### 関連ツール

| ツール | 役割 |
|-------|------|
| Migration Hub | 全体管理・ダッシュボード |
| AWS MGN | サーバーを移行 |
| AWS DMS | データベースを移行 |
| App2Container | アプリをコンテナ化 |

### まとめ
```
Migration Hub = 移行プロジェクトの管理ツール

・移行を実行するものではない
・各移行ツールの状況を一元管理
・「全体で今どこまで進んでる？」を把握する
```
